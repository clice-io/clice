# clangd 是怎么卡死的？

不知道平常在使用 clangd 的时候，是否遇到过 clangd 假死的情况。

clangd 一直在工作，然后更新文本啥的也没反应，必须要重启 clangd 才行。

那么为什么会造成这种情况呢？

# 基本的编译模型

# 任务该如何取消？

# 可能的解决方案

1 - 多进程

新开一个进程进行相关的工作，kill 进程

- Windows 上进程创建实现，可能造成用户体验不佳
- 进程间的状态同步很麻烦 ...

- 优点 crash 没事

2 - 协作式取消

一步步 parse，每次 parse 完之后都检查一下 flag。

还好 clang 提供了一个接口，允许我们在每次 parse 完一个声明之后检查一下状态。

## 协程与异步任务的取消


## 结语

至此问题的成因和解决方案都给出了，剩下的就是在代码中进行实践以及测试效果如何了。。。。
